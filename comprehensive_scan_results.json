{
  "summary": {
    "total_tests": 11,
    "vulnerabilities_found": 2,
    "tests_passed": 9,
    "security_score": "81.8%"
  },
  "by_severity": {
    "critical": {
      "total": 5,
      "vulnerable": 1,
      "secure": 4
    },
    "high": {
      "total": 4,
      "vulnerable": 0,
      "secure": 4
    },
    "medium": {
      "total": 2,
      "vulnerable": 1,
      "secure": 1
    }
  },
  "results": [
    {
      "test_name": "Missing Authentication",
      "type": "authentication",
      "severity": "critical",
      "description": "Tests if server accepts requests without authentication",
      "vulnerable": true,
      "details": "Server accepts requests without authentication",
      "evidence": {
        "response": {
          "tools": [
            {
              "name": "create_record",
              "description": "INSERT a row into a table in the Dataverse database and returns the GUID ID of the created record. Authentication and authorization are handled by the Web API layer.",
              "inputSchema": {
                "type": "object",
                "properties": {
                  "tablename": {
                    "type": "string",
                    "description": "The logical name of the Dataverse table to insert into. System tables: 'account', 'contact', 'lead', 'opportunity', 'incident', 'task', 'appointment', 'email', 'phonecall', 'systemuser', 'team', 'product', 'quote', 'invoice'. Custom tables typically have publisher prefix like 'crb69_customtable'. Table must be enabled in Web API settings and user must have create permissions."
                  },
                  "item": {
                    "type": "string",
                    "description": "Row data as stringified JSON object. System table example: '{\"name\":\"Contoso Ltd\",\"telephone1\":\"555-1234\",\"websiteurl\":\"https://contoso.com\"}'. Custom table example: '{\"crb69_name\":\"John Doe\",\"crb69_email\":\"john@example.com\"}'. Only fields enabled in Web API configuration will be accepted."
                  }
                },
                "required": [
                  "tablename",
                  "item"
                ],
                "additionalProperties": false,
                "$schema": "http://json-schema.org/draft-07/schema#"
              }
            },
            {
              "name": "read_record",
              "description": "SELECT/query rows from a table in the Dataverse database with OData query support. Authentication and authorization are handled by the Web API layer.",
              "inputSchema": {
                "type": "object",
                "properties": {
                  "tablename": {
                    "type": "string",
                    "description": "The logical name of the Dataverse table to query from. System tables: 'account', 'contact', 'lead', 'opportunity', 'incident', 'task', 'appointment', 'email', 'phonecall', 'systemuser', 'team', 'product', 'quote', 'invoice'. Custom tables typically have publisher prefix like 'crb69_customtable'. Table must be enabled in Web API settings and user must have read permissions."
                  },
                  "id": {
                    "type": "string",
                    "description": "Optional: Specific record GUID ID to retrieve a single record (format: 12345678-1234-1234-1234-123456789012). If not provided, returns multiple records based on other criteria."
                  },
                  "select": {
                    "type": "string",
                    "description": "Optional: Comma-separated list of column names to select. System table examples: 'name,telephone1,emailaddress1' (account), 'firstname,lastname,jobtitle' (contact). Custom tables use prefixed names like 'crb69_name,crb69_status'. Only fields user has permission to access will be returned."
                  },
                  "filter": {
                    "type": "string",
                    "description": "Optional: OData filter expression. Examples: 'statecode eq 0', 'name eq \\'Contoso\\'', 'createdon gt 2024-01-01T00:00:00Z', 'telephone1 ne null'. Use standard OData operators: eq, ne, gt, lt, ge, le, and, or, not."
                  },
                  "orderby": {
                    "type": "string",
                    "description": "Optional: OData orderby expression. Examples: 'name asc', 'createdon desc', 'name asc,createdon desc'. Default is ascending if direction not specified."
                  },
                  "top": {
                    "type": "string",
                    "description": "Optional: Number of records to return (1-100). Default is 10 if not specified and no ID provided. Use for pagination and limiting results."
                  },
                  "expand": {
                    "type": "string",
                    "description": "Optional: Related records to include. Examples: 'primarycontactid' (for accounts), 'parentaccountid' (for accounts), 'ownerid'. Navigation property names depend on table relationships."
                  }
                },
                "required": [
                  "tablename"
                ],
                "additionalProperties": false,
                "$schema": "http://json-schema.org/draft-07/schema#"
              }
            },
            {
              "name": "update_record",
              "description": "UPDATE a row in a table in the Dataverse database using the record's GUID ID. Returns success confirmation or error details. Authentication and authorization are handled by the Web API layer.",
              "inputSchema": {
                "type": "object",
                "properties": {
                  "tablename": {
                    "type": "string",
                    "description": "The logical name of the Dataverse table to update. System tables: 'account', 'contact', 'lead', 'opportunity', 'incident', 'task', 'appointment', 'email', 'phonecall', 'systemuser', 'team', 'product', 'quote', 'invoice'. Custom tables typically have publisher prefix like 'crb69_customtable'. Table must be enabled in Web API settings and user must have update permissions."
                  },
                  "id": {
                    "type": "string",
                    "description": "The GUID identifier of the record to update. Format: '12345678-1234-1234-1234-123456789012'. Must be a valid GUID for an existing record in the specified table."
                  },
                  "item": {
                    "type": "string",
                    "description": "Updated row data as stringified JSON object containing only the fields to modify. System table example: '{\"name\":\"Updated Company Name\",\"telephone1\":\"555-9999\"}'. Custom table example: '{\"crb69_name\":\"Jane Doe\",\"crb69_status\":\"Active\"}'. Only fields enabled in Web API configuration will be accepted."
                  }
                },
                "required": [
                  "tablename",
                  "id",
                  "item"
                ],
                "additionalProperties": false,
                "$schema": "http://json-schema.org/draft-07/schema#"
              }
            },
            {
              "name": "delete_record",
              "description": "DELETE a row from a table in the Dataverse database using the record's GUID ID. Returns success confirmation or error details. Authentication and authorization are handled by the Web API layer. WARNING: This operation is permanent and cannot be undone.",
              "inputSchema": {
                "type": "object",
                "properties": {
                  "tablename": {
                    "type": "string",
                    "description": "The logical name of the Dataverse table to delete from. System tables: 'account', 'contact', 'lead', 'opportunity', 'incident', 'task', 'appointment', 'email', 'phonecall', 'systemuser', 'team', 'product', 'quote', 'invoice'. Custom tables typically have publisher prefix like 'crb69_customtable'. Table must be enabled in Web API settings and user must have delete permissions."
                  },
                  "id": {
                    "type": "string",
                    "description": "The GUID identifier of the record to delete. Format: '12345678-1234-1234-1234-123456789012'. Must be a valid GUID for an existing record in the specified table. Record will be permanently removed from the database."
                  }
                },
                "required": [
                  "tablename",
                  "id"
                ],
                "additionalProperties": false,
                "$schema": "http://json-schema.org/draft-07/schema#"
              }
            }
          ]
        }
      }
    },
    {
      "test_name": "Weak Authentication",
      "type": "authentication",
      "severity": "high",
      "description": "Tests for weak authentication mechanisms",
      "vulnerable": false,
      "details": "No weak credentials found (test requires auth mechanism details)",
      "evidence": null
    },
    {
      "test_name": "Authorization Bypass",
      "type": "authorization",
      "severity": "critical",
      "description": "Tests if users can access unauthorized resources",
      "vulnerable": false,
      "details": "Authorization appears to be enforced",
      "evidence": null
    },
    {
      "test_name": "Input Validation - SQL Injection",
      "type": "input_validation",
      "severity": "critical",
      "description": "Tests for SQL injection vulnerabilities",
      "vulnerable": false,
      "details": "No SQL injection vulnerabilities detected",
      "evidence": null
    },
    {
      "test_name": "Input Validation - XXE",
      "type": "input_validation",
      "severity": "high",
      "description": "Tests for XML External Entity vulnerabilities",
      "vulnerable": false,
      "details": "No XXE vulnerabilities detected",
      "evidence": null
    },
    {
      "test_name": "Path Traversal",
      "type": "path_traversal",
      "severity": "high",
      "description": "Tests for directory traversal vulnerabilities",
      "vulnerable": false,
      "details": "No path traversal vulnerabilities detected",
      "evidence": null
    },
    {
      "test_name": "Command Injection",
      "type": "command_injection",
      "severity": "critical",
      "description": "Tests for OS command injection vulnerabilities",
      "vulnerable": false,
      "details": "No command injection vulnerabilities detected",
      "evidence": null
    },
    {
      "test_name": "Remote Code Execution",
      "type": "remote_code_execution",
      "severity": "critical",
      "description": "Tests for remote code execution vulnerabilities",
      "vulnerable": false,
      "details": "No remote code execution vulnerabilities detected",
      "evidence": null
    },
    {
      "test_name": "Rate Limiting",
      "type": "rate_limiting",
      "severity": "medium",
      "description": "Tests if server has proper rate limiting",
      "vulnerable": true,
      "details": "No rate limiting detected - all 100 requests succeeded",
      "evidence": {
        "requests_sent": 100
      }
    },
    {
      "test_name": "Resource Exhaustion",
      "type": "resource_exhaustion",
      "severity": "high",
      "description": "Tests for DoS via resource exhaustion",
      "vulnerable": false,
      "details": "Server has input size limits",
      "evidence": null
    },
    {
      "test_name": "Information Disclosure",
      "type": "information_disclosure",
      "severity": "medium",
      "description": "Tests for sensitive information leakage",
      "vulnerable": false,
      "details": "No obvious information disclosure detected",
      "evidence": null
    }
  ]
}